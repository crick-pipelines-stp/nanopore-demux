singularity.pullTimeout = '1800s'

params {
    dorado_model = "sup"
    dorado_batch_processing = true
    dorado_batch_num = 5
}

process {
  withName: 'DORADO_BASECALLER' {
      cpus = 5
      memory = 64.GB
    //   time = { "${params.dorado_auto_model == 'sup' ? '168.h' : '48.h'}" }
      time = 24.h
      queue = 'gpu'
    //   clusterOptions = { "${params.dorado_model == 'sup' ? '--gres=gpu:4' : '--gres=gpu:2'}" }
      clusterOptions = "--gres=gpu:${params.dorado_gpu_num}"
      containerOptions = '--nv'
  }

  withName: 'DORADO_DEMUX' {
      cpus = 1
      memory = 8.GB
      time = 24.h
  }

  withName: 'CHOPPER' {
      cpus = 2
      memory = 8.GB
      time = 24.h
  }

  withName: 'TOULLIGQC.*' {
      cpus = 10
      memory = 64.GB
      time = 12.h
  }
}
